import sys
import time
import bruteforce
import intro
# Web Explotation

def fast_print(text="", delay=0.03):
    """Prints text one character at a time very fast."""
    for char in text:
        sys.stdout.write(char)
        sys.stdout.flush()
        time.sleep(delay)
    print()

def login():
    username = input("Username: ")
    password = input("Password: ")
    if password == "abc456" and username == "admin":
        fast_print("Congradulations you made it into the website.")
        fast_print("You can now deface it.")
        intro.main()



def robots():
    fast_print("The URL for the website is: https://hack_techco.com")
    fast_print("What could be added to that url to get more info?")
    fast_print("(If you are stuck leave the input blank)")
    awnser1 = input()
    if awnser1 == "":
        fast_print("Hint: /r-----.txt")
        fast_print()
        robots()
    elif awnser1 == "/robots.txt":
        fast_print("You are redirected to a page that displays the following:")
        fast_print()
        fast_print("User-agent: *")
        fast_print("Disallow: /8033f.html")
        correct_url = input("Input the full URL: ")
        if correct_url == "https://hack_techco.com/8033f.html":
            fast_print("Congradulations you made it into the website.")
            intro.main()
        else: 
            fast_print("Not quite. Keep trying.")
        robots()
    else:
        fast_print("Not quite. Keep trying.")
        robots()
    
def brute_force():
    bruteforce.start()

def SQL():
    database = " login_database\n clients\n product_list\n"
    login_database = "Username: admin\n Password: YWJjNDU2\n"
    fast_print("SQL Injections is code that you insert into the website username/login")
    fast_print("Look into the most common SQL injections online and try to get the Database.")
    fast_print("If you are stuck leave the input blank. And I can help you.")
    input("(Enter to Continue)")
    while True:
        username = input(" Username: ")
        if "SHOW TABLES;" in username:
            fast_print(database)
            fast_print("Great Job! Now try to find the login information")
            if "SELECT * FROM login_database;" in username:
                fast_print(login_database)
                fast_print("Well done. Now you have access to the website login info.")
                fast_print("It seems the password is encrypted. Try to decrypt it using a web browser tool.")
                login()
        elif "SELECT * FROM login_database;" in username:
            fast_print(login_database)
            fast_print("Well done. Now you have access to the website login info.")
            fast_print("It seems the password is encrypted. Try to decrypt it using a web browser tool.")
            login()
        elif username == "admin":
            password = input("Password: ")
            if password == "abc456":
                fast_print("Congradulations you made it into the website.")
                intro.victory()
            else:
                fast_print("Password is incorrect")
                fast_print("Try decrypting it using www.base64decode.org")
        elif username == "":
            fast_print("Here is a helpful website to learn about SQL injections: www.w3schools.com/sql/sql_injection.asp")
        else:
            fast_print("Input was not a SQL inquery. Make sure you have a ; at the end.")

def cookies():
    fast_print(" 1- Elements\n 2- Console\n 3- Sources\n 4- Network\n 5- Performance\n 6- Memory\n 7- Application")
    page = input("(Input the #): ")
    if page == "7":
        fast_print("Good work. You can know navigate to the cookie value.")
        fast_print("eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOmZhbHNlLCJpYXQiOjE3NDM4NzM3NDgsImV4cCI6MTc0Mzg3NzM0OH0.EFZV9DwbaxfjDd69490to-uyko1grUnJ7cPd-uCpFnI")
        fast_print("Go to token.dev and manipulate the cookie value.")
        fast_print("(If you need my help leave the input blank)")
        while True:
            alt_cookie = input("Input the altered cookie here: ")
            if alt_cookie == "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTc0Mzg3Mzc0OCwiZXhwIjoxNzQzODc3MzQ4fQ":
                intro.victory()
            elif alt_cookie == "":
                fast_print("Try changin the algorithm/admin value. If you are still stuck input a ? and I can give you further assitance.")
            elif alt_cookie == "?":
                fast_print("Step 1: Change the algorithm to none.")
                fast_print("Step 2: Change the admin value to true")
            else: 
                fast_print("That cookie doesn't work. Try again.")
    else: 
        fast_print("There doesn't seem to be any cookie here.")
        fast_print()
        cookies()
        

def attack_selection():
    fast_print("Which of the following ways would you like to try?")
    fast_print(" 1-URL Manipulation\n 2-Brute Force\n 3-SQL Injection\n 4-Cookie Manipulation")
    users_choice = input("(Input the #): ")
    if users_choice == "1":
        robots()
    elif users_choice == "2":
        brute_force()
    elif users_choice == "3":
        SQL()
    elif users_choice == "4":
        fast_print("First we need to get access to the websites cookies.")
        fast_print("After inspecting the page, where must you navigate to view website cookies")
        cookies()
    else:
        fast_print("Your input is invalid. Pick a number between 1-4.")
        fast_print()
        attack_selection()

def main():
    fast_print("I can deface the website I just need your help to get in.")
    fast_print("You have navigated to the H.A.C.K website and come across a login page.")
    fast_print("Try any username or password")
    fast_print()
    login()
    fast_print() 
    fast_print("Looks like we are gonna have to find another way in.")
    attack_selection()

if __name__ == "__main__":
    main()
